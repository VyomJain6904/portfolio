---
export const prerender = false;
import { getImage } from "astro:assets";
import AppLayout from "../layouts/AppLayout";
import mac from "../assets/images/mac.jpg";
import mac1 from "../assets/images/mac1.jpg";
import mac2 from "../assets/images/mac2.jpg";
import mac3 from "../assets/images/mac3.jpg";

const backgrounds = [mac, mac1, mac2, mac3];

function getRandomBackground() {
	return `bg-${Math.floor(Math.random() * backgrounds.length) + 1}`;
}

const optimizedBackgrounds = await Promise.all(
	backgrounds.map((bg) =>
		getImage({
			src: bg,
			width: 3500,
		})
	)
);

const backgroundMap = Object.fromEntries(
	optimizedBackgrounds.map((bg, index) => [`bg-${index + 1}`, bg.src])
);
---

<AppLayout
	client:load
	initialBg={getRandomBackground()}
	backgroundMap={backgroundMap}
/>
